  <!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MCP Masalas | Pure & Fresh Spices</title>

  <style>
    :root {
      --accent: #c0392b;
      --accent-soft: #ffe8e4;
      --bg: #fffaf5;
      --card: #ffffff;
      --text-dark: #2c3e50;
      --text-soft: #7f8c8d;
      --radius-lg: 18px;
      --shadow-soft: 0 10px 30px rgba(0,0,0,0.08);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: var(--bg);
      color: var(--text-dark);
      line-height: 1.5;
    }

    a {
      text-decoration: none;
      color: inherit;
    }

    /* HEADER */
    header {
      position: sticky;
      top: 0;
      z-index: 10;
      backdrop-filter: blur(10px);
      background: rgba(255, 250, 245, 0.92);
      border-bottom: 1px solid rgba(0,0,0,0.04);
    }

    .nav {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0.7rem 1rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 0.6rem;
    }

    .brand-logo {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #ffeaa7, #d35400);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 800;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
    }

    .brand-text-main {
      font-size: 1.1rem;
      font-weight: 700;
      letter-spacing: 0.03em;
    }

    .brand-text-sub {
      font-size: 0.72rem;
      color: var(--text-soft);
      text-transform: uppercase;
      letter-spacing: 0.15em;
    }

    .nav-links {
      display: flex;
      gap: 1.1rem;
      font-size: 0.9rem;
    }

    .nav-links a {
      padding: 0.2rem 0;
      position: relative;
      color: var(--text-soft);
    }

    .nav-links a::after {
      content: "";
      position: absolute;
      left: 0;
      bottom: -3px;
      width: 0;
      height: 2px;
      border-radius: 999px;
      background: var(--accent);
      transition: width 0.2s;
    }

    .nav-links a:hover {
      color: var(--accent);
    }

    .nav-links a:hover::after {
      width: 100%;
    }

    /* LAYOUT */
    main {
      max-width: 1100px;
      margin: 0 auto;
      padding: 1.2rem 1rem 2rem;
      display: grid;
      grid-template-columns: minmax(0, 1fr);
      gap: 1.5rem;
    }

    .content-column {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    /* HERO */
    .hero {
      background: linear-gradient(135deg, #ffeaa7, #fffaf5);
      border-radius: var(--radius-lg);
      padding: 1.3rem 1.4rem;
      display: grid;
      grid-template-columns: minmax(0, 1.3fr) minmax(0, 1fr);
      gap: 1.2rem;
      align-items: center;
      box-shadow: var(--shadow-soft);
    }

    .hero-left h1 {
      font-size: 1.7rem;
      margin-bottom: 0.4rem;
    }

    .hero-left h1 span {
      color: var(--accent);
    }

    .hero-sub {
      font-size: 0.9rem;
      color: var(--text-soft);
      margin-bottom: 0.9rem;
    }

    .hero-badges {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      margin-bottom: 0.9rem;
    }

    .badge {
      font-size: 0.7rem;
      padding: 0.25rem 0.6rem;
      border-radius: 999px;
      background: rgba(255,255,255,0.9);
      border: 1px solid rgba(0,0,0,0.04);
    }

    .hero-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 0.6rem;
    }

    .btn-main, .btn-ghost {
      border-radius: 999px;
      border: none;
      padding: 0.5rem 1.1rem;
      font-size: 0.85rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      white-space: nowrap;
    }

    .btn-main {
      background: var(--accent);
      color: #fff;
      box-shadow: 0 8px 18px rgba(192, 57, 43, 0.35);
    }

    .btn-ghost {
      background: rgba(255,255,255,0.95);
      color: var(--text-dark);
      border: 1px solid rgba(0,0,0,0.06);
    }

    .hero-note {
      font-size: 0.75rem;
      color: var(--text-soft);
    }

    .hero-right {
      position: relative;
      height: 160px;
      border-radius: 18px;
      overflow: hidden;
      background: radial-gradient(circle at 10% 0%, #ffeaa7, #e67e22);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0.8rem;
    }

    .hero-spice-jar {
      width: 100%;
      height: 100%;
      border-radius: 22px;
      overflow: hidden;
      box-shadow: 0 14px 30px rgba(0,0,0,0.25);
      background: #fdfbfb;
    }

    .hero-spice-jar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .hero-tag {
      position: absolute;
      bottom: 0.4rem;
      left: 0.5rem;
      right: 0.5rem;
      background: rgba(255,255,255,0.94);
      border-radius: 999px;
      padding: 0.25rem 0.7rem;
      font-size: 0.68rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.4rem;
    }

    .hero-tag span {
      white-space: nowrap;
    }

    /* FILTERS */
    .filters {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      align-items: center;
      justify-content: space-between;
    }

    .filter-left {
      font-size: 0.85rem;
      color: var(--text-soft);
    }

    .filter-right {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
    }

    .chip {
      font-size: 0.75rem;
      padding: 0.25rem 0.65rem;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,0.06);
      background: rgba(255,255,255,0.95);
      cursor: pointer;
    }

    .chip.active {
      background: var(--accent);
      color: #fff;
      border-color: var(--accent);
    }

    /* PRODUCT GRID */
    .products {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 0.9rem;
    }

    .product-card {
      background: var(--card);
      border-radius: 16px;
      padding: 0.65rem;
      box-shadow: 0 8px 22px rgba(0,0,0,0.05);
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
      position: relative;
      overflow: hidden;
    }

    .product-img {
      height: 110px;
      border-radius: 14px;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-color: #f0ece4;
      margin-bottom: 0.35rem;
    }

    .product-title {
      font-size: 0.9rem;
      font-weight: 600;
    }

    .product-sub {
      font-size: 0.75rem;
      color: var(--text-soft);
    }

    .product-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 0.2rem;
      font-size: 0.8rem;
    }

    .price {
      font-weight: 700;
      color: var(--accent);
    }

    .unit {
      font-size: 0.7rem;
      color: var(--text-soft);
    }

    .product-actions {
      margin-top: 0.4rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.3rem;
    }

    .btn-add {
      border-radius: 999px;
      border: none;
      padding: 0.35rem 0.7rem;
      font-size: 0.78rem;
      background: var(--accent-soft);
      color: var(--accent);
      cursor: pointer;
      flex: 1;
    }

    .tag-small {
      font-size: 0.66rem;
      padding: 0.18rem 0.45rem;
      border-radius: 999px;
      background: rgba(0,0,0,0.03);
      color: var(--text-soft);
      white-space: nowrap;
    }

    /* CART AS FLOATING PANEL */
    .cart {
      position: fixed;
      right: 1rem;
      bottom: 4.5rem;
      width: min(320px, 94vw);
      max-height: 70vh;
      background: #ffffff;
      border-radius: var(--radius-lg);
      padding: 0.9rem;
      box-shadow: var(--shadow-soft);
      display: flex;
      flex-direction: column;
      gap: 0.6rem;
      transform: translateY(130%);
      opacity: 0;
      pointer-events: none;
      transition: transform 0.25s ease, opacity 0.25s ease;
      z-index: 15;
    }

    .cart.cart-open {
      transform: translateY(0);
      opacity: 1;
      pointer-events: auto;
    }

    .cart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .cart-title {
      font-size: 0.95rem;
      font-weight: 600;
    }

    .cart-badge {
      font-size: 0.75rem;
      padding: 0.15rem 0.5rem;
      border-radius: 999px;
      background: var(--accent-soft);
      color: var(--accent);
    }

    .cart-list {
      flex: 1;
      overflow-y: auto;
      border-top: 1px dashed rgba(0,0,0,0.07);
      border-bottom: 1px dashed rgba(0,0,0,0.07);
      padding: 0.45rem 0;
    }

    .cart-empty {
      font-size: 0.78rem;
      color: var(--text-soft);
      text-align: center;
      padding: 0.5rem 0.2rem;
    }

    .cart-item {
      display: grid;
      grid-template-columns: 1fr auto;
      align-items: center;
      column-gap: 0.4rem;
      row-gap: 0.15rem;
      font-size: 0.8rem;
      padding: 0.3rem 0;
    }

    .cart-item-name {
      font-weight: 500;
    }

    .cart-item-meta {
      font-size: 0.7rem;
      color: var(--text-soft);
    }

    .cart-item-qty {
      display: inline-flex;
      align-items: center;
      gap: 0.2rem;
      border-radius: 999px;
      background: rgba(0,0,0,0.03);
      padding: 0.15rem 0.35rem;
    }

    .cart-item-qty button {
      border: none;
      background: transparent;
      cursor: pointer;
      font-size: 0.8rem;
      line-height: 1;
    }

    .cart-item-price {
      text-align: right;
      font-weight: 600;
      color: var(--accent);
      font-size: 0.8rem;
    }

    .cart-footer {
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
      font-size: 0.8rem;
    }

    .cart-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .cart-total {
      font-weight: 700;
      font-size: 0.9rem;
    }

    .btn-whatsapp {
      margin-top: 0.2rem;
      border-radius: 999px;
      border: none;
      padding: 0.5rem 0.75rem;
      font-size: 0.85rem;
      cursor: pointer;
      background: #25d366;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.4rem;
      box-shadow: 0 8px 20px rgba(37,211,102,0.4);
    }

    .btn-clear {
      margin-top: 0.1rem;
      border-radius: 999px;
      border: none;
      padding: 0.3rem 0.6rem;
      font-size: 0.72rem;
      cursor: pointer;
      background: rgba(0,0,0,0.04);
      color: var(--text-soft);
    }

    .cart-fab {
      position: fixed;
      right: 1rem;
      bottom: 1.2rem;
      width: 52px;
      height: 52px;
      border-radius: 50%;
      border: none;
      background: var(--accent);
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.4rem;
      box-shadow: 0 8px 20px rgba(0,0,0,0.25);
      cursor: pointer;
      z-index: 20;
    }

    .cart-fab span {
      pointer-events: none;
    }

    .cart-fab-count {
      position: absolute;
      top: 6px;
      right: 6px;
      min-width: 18px;
      height: 18px;
      border-radius: 999px;
      background: #ffffff;
      color: var(--accent);
      font-size: 0.7rem;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0 0 2px var(--accent-soft);
    }

    /* ABOUT + CONTACT SECTION */
    .info-section {
      margin-top: 1rem;
      display: grid;
      grid-template-columns: minmax(0, 1.4fr) minmax(0, 1fr);
      gap: 0.9rem;
    }

    .card {
      background: #ffffff;
      padding: 0.9rem;
      border-radius: var(--radius-lg);
      box-shadow: 0 8px 22px rgba(0,0,0,0.04);
      font-size: 0.82rem;
      color: var(--text-soft);
    }

    .card h2 {
      font-size: 0.95rem;
      color: var(--text-dark);
      margin-bottom: 0.4rem;
    }

    .card ul {
      margin-left: 1rem;
      margin-top: 0.2rem;
    }

    .card li {
      margin-bottom: 0.2rem;
    }

    .contact-details {
      margin-top: 0.4rem;
      font-size: 0.8rem;
    }

    .contact-details div {
      margin-bottom: 0.2rem;
    }

    .contact-details span {
      font-weight: 500;
    }

    .small-note {
      font-size: 0.72rem;
      margin-top: 0.3rem;
    }

    /* ADMIN PANEL */
    #adminSection h3 {
      font-size: 0.9rem;
      margin: 0.4rem 0;
      color: var(--text-dark);
    }

    .admin-note {
      font-size: 0.74rem;
      color: var(--text-soft);
      margin-top: 0.3rem;
    }

    .admin-row {
      margin-top: 0.5rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      align-items: center;
      justify-content: space-between;
    }

    .admin-inputs {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 0.4rem;
      margin-top: 0.4rem;
    }

    .admin-inputs label {
      font-size: 0.75rem;
      display: flex;
      flex-direction: column;
      gap: 0.15rem;
    }

    .brand-image {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      object-fit: cover;
    }

    .admin-inputs input,
    .admin-inputs select {
      border-radius: 8px;
      border: 1px solid rgba(0,0,0,0.12);
      padding: 0.3rem 0.4rem;
      font-size: 0.78rem;
      outline: none;
    }

    .admin-inputs input:focus,
    .admin-inputs select:focus {
      border-color: var(--accent);
    }

    .btn-small {
      border-radius: 999px;
      border: none;
      padding: 0.3rem 0.7rem;
      font-size: 0.75rem;
      cursor: pointer;
      background: var(--accent);
      color: #fff;
    }

    .btn-outline {
      background: transparent;
      color: var(--text-soft);
      border: 1px solid rgba(0,0,0,0.12);
    }

    .admin-table-wrap {
      margin-top: 0.6rem;
      max-height: 260px;
      overflow: auto;
      border-radius: 12px;
      border: 1px solid rgba(0,0,0,0.06);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.76rem;
    }

    th, td {
      padding: 0.3rem 0.4rem;
      border-bottom: 1px solid rgba(0,0,0,0.06);
      text-align: left;
      vertical-align: middle;
    }

    th {
      background: rgba(0,0,0,0.02);
      position: sticky;
      top: 0;
      z-index: 1;
    }

    .admin-badge {
      display: inline-block;
      padding: 0.1rem 0.4rem;
      border-radius: 999px;
      font-size: 0.65rem;
    }

    .admin-badge-active {
      background: #e8f8f5;
      color: #148f77;
    }

    .admin-badge-inactive {
      background: #fdecea;
      color: #c0392b;
    }

    .admin-msg {
      margin-top: 0.3rem;
      font-size: 0.75rem;
    }

    .admin-msg.error {
      color: #c0392b;
    }

    .admin-msg.success {
      color: #148f77;
    }

    /* Profile cards (owner + developer) */
    .profile-card-header {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      margin-bottom: 0.4rem;
    }

    .profile-photo {
      width: 52px;
      height: 52px;
      border-radius: 50%;
      object-fit: cover;
      box-shadow: 0 4px 10px rgba(0,0,0,0.12);
      flex-shrink: 0;
    }

    @media (max-width: 900px) {
      .hero {
        grid-template-columns: minmax(0, 1fr);
        padding: 1.1rem;
      }

      .info-section {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    @media (max-width: 640px) {
      .nav-links {
        display: none;
      }

      .hero-left h1 {
        font-size: 1.45rem;
      }

      .products {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      }

      #adminProductsTable th,
      #adminProductsTable td,
      #adminOrdersTable th,
      #adminOrdersTable td {
        font-size: 0.7rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <nav class="nav">
      <div class="brand">
        <!-- üñºÔ∏è Image instead of .brand-logo -->
        <img src="logo.png" alt="MCP Masalas logo" class="brand-image" />
        <div>
          <div class="brand-text-main">MCP Masalas</div>
          <div class="brand-text-sub">Pure ‚Ä¢ Fresh ‚Ä¢ Aromatic</div>
        </div>
      </div>

      <div class="nav-links">
        <a href="#products">Products</a>
        <a href="#about">About</a>
        <a href="#contact">Contact</a>
        <a href="#adminSection">Admin</a>
      </div>

      <button class="nav-btn" id="navWhatsAppBtn">
      </button>
    </nav>
  </header>

  <main>
    <div class="content-column">
      <section class="hero">
        <div class="hero-left">
          <h1>Bring home <span>authentic flavour</span> with MCP Masalas.</h1>
          <p class="hero-sub">
            Handpicked spices, slow-roasted and stone-ground to keep the natural aroma and taste.
          </p>

          <div class="hero-badges">
            <div class="badge">‚ú® No added colours</div>
            <div class="badge">üß™ Preservative free</div>
            <div class="badge">üå∂Ô∏è Small batch fresh grind</div>
          </div>

          <div class="hero-actions">
            <button class="btn-main" id="scrollToProducts">
              Browse Products ‚¨á
            </button>
            <button class="btn-ghost" id="heroWhatsAppBtn">
              Chat on WhatsApp
            </button>
          </div>

          <div class="hero-note">
            Same-day delivery available in selected areas. Cash on Delivery & UPI accepted.
          </div>
        </div>

        <div class="hero-right">
          <div class="hero-spice-jar">
            <img src="hero-spices.png" alt="MCP Masalas best spices" />
          </div>
          <div class="hero-tag">
            <span>Best sellers: All type of Masalas üî•</span>
          </div>
        </div>
      </section>

      <!-- FILTER + PRODUCTS -->
      <section id="products">
        <div class="filters">
          <div class="filter-left">
            <strong>Explore masalas</strong><br/>
            Choose from ready blends & single spices.
          </div>
          <div class="filter-right">
            <button class="chip active" data-filter="all">All</button>
            <button class="chip" data-filter="blend">Blends</button>
            <button class="chip" data-filter="single">Single Spices</button>
            <button class="chip" data-filter="special">Special</button>
          </div>
        </div>

        <div class="products" id="productList">
          <!-- JS + Supabase inject product cards -->
        </div>
      </section>

      <!-- ABOUT & CONTACT -->
      <section class="info-section">
        <div class="card" id="about">
          <h2>About MCP Masalas</h2>
          <p>
            MCP Masalas is your trusted destination for fresh, flavourful and hygienically packed spices.
            Every batch is carefully selected, cleaned and processed so that you can taste the difference
            in every bite.
          </p>
          <ul>
            <li>Carefully sourced raw spices</li>
            <li>Small batch roasting & grinding</li>
            <li>Properly sealed, food-grade packing</li>
            <li>Custom bulk orders for hotels & caterers</li>
          </ul>
        </div>

        <div class="card" id="contact">
          <h2>Contact & Store Timings</h2>
          <div class="contact-details">
            <div><span>Shop Name:</span> MCP Masalas</div>
            <div><span>Location:</span> Your shop address here</div>
            <div><span>Phone / WhatsApp:</span> +91-98765-43210</div>
            <div><span>Email:</span> youremail@example.com</div>
            <div><span>Timings:</span> 9:00 AM ‚Äì 9:30 PM (All days)</div>
          </div>
          <p class="small-note">
            For bulk / party orders, message us on WhatsApp with your requirements. We also
            provide custom blends on request (minimum quantity applies).
          </p>
        </div>
      </section>

      <!-- ADMIN PANEL -->
      <section class="card" id="adminSection">
        <h2>Admin Panel (MCP)</h2>
        <p class="admin-note">
          This area is only for the shop owner. Login using the admin email/password created in Supabase.
        </p>

        <!-- LOGGED OUT VIEW -->
        <div id="adminLoggedOut">
          <form id="adminLoginForm" style="margin-top:0.6rem; display:grid; gap:0.4rem; max-width:320px;">
            <label style="font-size:0.78rem; display:flex; flex-direction:column; gap:0.15rem;">
              Email
              <input type="email" id="adminEmailInput" required />
            </label>
            <label style="font-size:0.78rem; display:flex; flex-direction:column; gap:0.15rem;">
              Password
              <input type="password" id="adminPasswordInput" required />
            </label>
            <button type="submit" class="btn-small">Login</button>
          </form>
          <div id="adminAuthMsg" class="admin-msg"></div>
        </div>

        <!-- LOGGED IN VIEW -->
        <div id="adminLoggedIn" style="display:none; margin-top:0.6rem;">
          <div class="admin-row">
            <div style="font-size:0.8rem;">
              Logged in as <strong id="adminUserEmail"></strong>
            </div>
            <button id="adminLogoutBtn" class="btn-small btn-outline">Logout</button>
          </div>

          <h3>Product editor</h3>
          <form id="productForm">
            <input type="hidden" id="productId" />
            <div class="admin-inputs">
              <label>
                Name
                <input id="productName" required />
              </label>
              <label>
                Type
                <select id="productType">
                  <option value="blend">Blend</option>
                  <option value="single">Single Spice</option>
                  <option value="special">Special</option>
                </select>
              </label>
              <label>
                Price (‚Çπ)
                <input type="number" id="productPrice" min="0" step="1" required />
              </label>
              <label>
                Unit
                <input id="productUnit" placeholder="100 g" required />
              </label>
              <label>
                Tag
                <input id="productTag" placeholder="For biryani / etc" />
              </label>
              <label>
                Image URL
                <input id="productImgUrl" placeholder="https://..." />
              </label>
              <label>
                Stock
                <input type="number" id="productStock" min="0" step="1" />
              </label>
              <label>
                Sort order
                <input type="number" id="productSortOrder" step="1" />
              </label>
              <label>
                Active?
                <select id="productIsActive">
                  <option value="true">Yes</option>
                  <option value="false">No</option>
                </select>
              </label>
            </div>

            <div class="admin-row" style="margin-top:0.6rem;">
              <div>
                <button type="submit" class="btn-small" id="productSaveBtn">Save product</button>
                <button type="button" class="btn-small btn-outline" id="productResetBtn" style="margin-left:0.4rem;">
                  Clear form
                </button>
              </div>
              <div id="productFormMsg" class="admin-msg"></div>
            </div>
          </form>

          <h3 style="margin-top:0.7rem;">All products</h3>
          <div class="admin-table-wrap">
            <table id="adminProductsTable">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Type</th>
                  <th>Price</th>
                  <th>Unit</th>
                  <th>Stock</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <!-- JS render products -->
              </tbody>
            </table>
          </div>

          <h3 style="margin-top:0.7rem;">Customer orders</h3>
          <div class="admin-table-wrap">
            <table id="adminOrdersTable">
              <thead>
                <tr>
                  <th>Time</th>
                  <th>Name</th>
                  <th>Phone</th>
                  <th>Area</th>
                  <th>Total (‚Çπ)</th>
                  <th>Payment Proof</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <!-- JS -->
              </tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- OWNER & DEVELOPER CARDS (BELOW ADMIN PANEL) -->
      <section class="info-section" style="margin-top: 1rem;">
        <!-- Owner card -->
        <div class="card">
          <div class="profile-card-header">
            <img src="owner.jpg" alt="MCP Masalas Owner" class="profile-photo" />
            <div>
              <h2>Owner - MCP Masalas</h2>
              <div style="font-size:0.78rem; color:var(--text-soft);">Shop Owner</div>
            </div>
          </div>
          <div class="contact-details">
            <div><span>Name:</span> MD Chand Pasha</div>
            <div><span>Contact:</span> 9441741141</div>
          </div>
        </div>

        <!-- Developer card -->
        <div class="card">
          <div class="profile-card-header">
            <img src="developer.jpg" alt="Website Developer" class="profile-photo" />
            <div>
              <h2>Developer</h2>
              <div style="font-size:0.78rem; color:var(--text-soft);">Web Developer & Designer</div>
            </div>
          </div>
          <div class="contact-details">
            <div><span>Name:</span> Muhammad Aman</div>
            <div><span>Email:</span> aman9059089036@gmail.com</div>
          </div>
        </div>
      </section>

      <!-- FOOTER LINE AFTER CARDS -->
      <footer style="text-align:center; padding:10px 0; font-size:0.8rem; color:#7f8c8d; margin-top:0.5rem;">
        ¬© 2025 MCP Masalas ‚Äî All Rights Reserved
      </footer>

    </div>
  </main>

  <!-- FLOATING CART PANEL -->
  <aside class="cart">
    <div class="cart-header">
      <div class="cart-title">Your Cart</div>
      <div class="cart-badge"><span id="cartCount">0</span> items</div>
    </div>

    <div class="cart-list" id="cartList">
      <div class="cart-empty">Add some masalas to see them here.</div>
    </div>

    <div class="cart-footer">
      <div class="cart-row">
        <span>Subtotal</span>
        <span>‚Çπ <span id="cartSubtotal">0</span></span>
      </div>
      <div class="cart-row">
        <span>Approx. Delivery</span>
        <span>‚Çπ <span id="deliveryCharge">0</span></span>
      </div>
      <div class="cart-row cart-total">
        <span>Estimated Total</span>
        <span>‚Çπ <span id="cartTotal">0</span></span>
      </div>

      <button class="btn-whatsapp" id="checkoutWhatsApp">
        üõí Place Order on WhatsApp
      </button>
      <button class="btn-clear" id="clearCart">
        Clear Cart
      </button>
    </div>
  </aside>

  <!-- FLOATING CART ICON -->
  <button class="cart-fab" id="cartFab">
    <span>üõí</span>
    <span class="cart-fab-count" id="cartFabCount">0</span>
  </button>

  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";

    const SUPABASE_URL = "https://kkrqcprhnafrhgjqhwrg.supabase.co";
    const SUPABASE_ANON_KEY =
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtrcnFjcHJobmFmcmhnanFod3JnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQxOTYzNjEsImV4cCI6MjA3OTc3MjM2MX0.-udhnc4gYVwkPX8aeD8oaWCnt6VcPWIqmG6FF4rYUFk";
    const MCP_WHATSAPP_NUMBER = "919059089036";

    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    let products = [];
    let currentFilter = "all";
    const cart = {};

    const productListEl = document.getElementById("productList");
    const cartListEl = document.getElementById("cartList");
    const cartCountEl = document.getElementById("cartCount");
    const cartSubtotalEl = document.getElementById("cartSubtotal");
    const cartTotalEl = document.getElementById("cartTotal");
    const deliveryChargeEl = document.getElementById("deliveryCharge");
    const cartFab = document.getElementById("cartFab");
    const cartFabCountEl = document.getElementById("cartFabCount");
    const cartEl = document.querySelector(".cart");

    const adminLoggedOutEl = document.getElementById("adminLoggedOut");
    const adminLoggedInEl = document.getElementById("adminLoggedIn");
    const adminAuthMsgEl = document.getElementById("adminAuthMsg");
    const adminUserEmailEl = document.getElementById("adminUserEmail");
    const adminLoginForm = document.getElementById("adminLoginForm");
    const adminEmailInput = document.getElementById("adminEmailInput");
    const adminPasswordInput = document.getElementById("adminPasswordInput");
    const adminLogoutBtn = document.getElementById("adminLogoutBtn");

    const productForm = document.getElementById("productForm");
    const productIdInput = document.getElementById("productId");
    const productNameInput = document.getElementById("productName");
    const productTypeInput = document.getElementById("productType");
    const productPriceInput = document.getElementById("productPrice");
    const productUnitInput = document.getElementById("productUnit");
    const productTagInput = document.getElementById("productTag");
    const productImgUrlInput = document.getElementById("productImgUrl");
    const productStockInput = document.getElementById("productStock");
    const productSortOrderInput = document.getElementById("productSortOrder");
    const productIsActiveInput = document.getElementById("productIsActive");
    const productFormMsgEl = document.getElementById("productFormMsg");
    const productResetBtn = document.getElementById("productResetBtn");
    const adminProductsTableBody = document.querySelector(
      "#adminProductsTable tbody"
    );
    const adminOrdersTableBody = document.querySelector(
      "#adminOrdersTable tbody"
    );

    function formatCurrency(value) {
      return Number(value || 0).toFixed(0);
    }

    function getFilteredProducts() {
      if (currentFilter === "all") return products;
      return products.filter((p) => p.type === currentFilter);
    }

    function showAdminMessage(el, msg, type = "") {
      if (!el) return;
      el.textContent = msg || "";
      el.className = "admin-msg";
      if (type) el.classList.add(type);
    }

    async function loadProductsFromSupabase() {
      try {
        const { data, error } = await supabase
          .from("products")
          .select("*")
          .eq("is_active", true)
          .order("sort_order", { ascending: true })
          .order("name", { ascending: true });

        if (error) {
          console.error("Error loading products:", error);
          if (!products.length) {
            products = [
              {
                id: 1,
                name: "Garam Masala",
                type: "blend",
                price: 120,
                unit: "100 g",
                tag: "All purpose",
                img_url: "",
                stock: 0,
              },
              {
                id: 2,
                name: "Red Chilli Powder",
                type: "single",
                price: 90,
                unit: "100 g",
                tag: "Medium spicy",
                img_url: "",
                stock: 0,
              },
            ];
          }
        } else {
          products = data || [];
        }
      } catch (err) {
        console.error("Unexpected error loading products:", err);
        if (!products.length) {
          products = [
            {
              id: 1,
              name: "Garam Masala",
              type: "blend",
              price: 120,
              unit: "100 g",
              tag: "All purpose",
              img_url: "",
              stock: 0,
            },
            {
              id: 2,
              name: "Red Chilli Powder",
              type: "single",
              price: 90,
              unit: "100 g",
              tag: "Medium spicy",
              img_url: "",
              stock: 0,
            },
          ];
        }
      } finally {
        renderProducts();
      }
    }

    function renderProducts() {
      const list = getFilteredProducts();
      productListEl.innerHTML = "";

      if (!list.length) {
        productListEl.innerHTML = "<p>No products found.</p>";
        return;
      }

      list.forEach((product) => {
        const card = document.createElement("article");
        card.className = "product-card";

        const imgDiv = document.createElement("div");
        imgDiv.className = "product-img";
        if (product.img_url) {
          imgDiv.style.backgroundImage = `url("${product.img_url}")`;
        }

        const title = document.createElement("div");
        title.className = "product-title";
        title.textContent = product.name;

        const sub = document.createElement("div");
        sub.className = "product-sub";
        sub.textContent =
          product.type === "blend"
            ? "Masala Blend"
            : product.type === "single"
            ? "Single Spice"
            : "Special Blend";

        const meta = document.createElement("div");
        meta.className = "product-meta";
        meta.innerHTML = `
          <span class="price">‚Çπ ${formatCurrency(product.price)}</span>
          <span class="unit">${product.unit}</span>
        `;

        const actions = document.createElement("div");
        actions.className = "product-actions";

        const btnAdd = document.createElement("button");
        btnAdd.className = "btn-add";
        btnAdd.textContent =
          product.stock > 0 ||
          product.stock === null ||
          product.stock === undefined
            ? "Add to cart"
            : "Out of stock";

        btnAdd.disabled = product.stock === 0;
        btnAdd.addEventListener("click", () => addToCart(product.id));

        const tag = document.createElement("div");
        tag.className = "tag-small";
        let tagText = product.tag || "Best Quality";
        if (product.stock === 0) tagText = "Out of stock";
        else if (typeof product.stock === "number" && product.stock <= 5)
          tagText = `Only ${product.stock} left`;
        tag.textContent = tagText;

        actions.appendChild(btnAdd);
        actions.appendChild(tag);

        card.appendChild(imgDiv);
        card.appendChild(title);
        card.appendChild(sub);
        card.appendChild(meta);
        card.appendChild(actions);

        productListEl.appendChild(card);
      });
    }

    async function loadAdminOrders() {
      try {
        const { data, error } = await supabase
          .from("orders")
          .select(
            "id, created_at, customer_name, phone, delivery_area, total, payment_proof_url"
          )
          .order("created_at", { ascending: false })
          .limit(100);

        if (error) {
          console.error("Admin load orders error:", error);
          return;
        }
        renderAdminOrdersTable(data || []);
      } catch (err) {
        console.error("Admin load orders unexpected error:", err);
      }
    }

    function renderAdminOrdersTable(list) {
      adminOrdersTableBody.innerHTML = "";

      if (!list.length) {
        adminOrdersTableBody.innerHTML = `
      <tr><td colspan="7" style="font-size:0.8rem; color:#7f8c8d;">
        No orders found yet.
      </td></tr>`;
        return;
      }

      list.forEach((order) => {
        const tr = document.createElement("tr");

        const createdAt = order.created_at ? new Date(order.created_at) : null;
        const timeText = createdAt ? createdAt.toLocaleString() : "-";

        const tdTime = document.createElement("td");
        tdTime.textContent = timeText;

        const tdName = document.createElement("td");
        tdName.textContent = order.customer_name || "-";

        const tdPhone = document.createElement("td");
        tdPhone.textContent = order.phone || "-";

        const tdArea = document.createElement("td");
        tdArea.textContent = order.delivery_area || "-";

        const tdTotal = document.createElement("td");
        tdTotal.textContent = order.total
          ? `‚Çπ ${Number(order.total).toFixed(0)}`
          : "-";

        const tdProof = document.createElement("td");
        if (order.payment_proof_url) {
          const link = document.createElement("a");
          link.href = order.payment_proof_url;
          link.target = "_blank";
          const img = document.createElement("img");
          img.src = order.payment_proof_url;
          img.alt = "Payment proof";
          img.style.width = "60px";
          img.style.borderRadius = "6px";
          img.style.display = "block";
          link.appendChild(img);
          tdProof.appendChild(link);
        } else {
          tdProof.textContent = "No proof";
        }

        const tdActions = document.createElement("td");
        const delBtn = document.createElement("button");
        delBtn.textContent = "Delete";
        delBtn.className = "btn-small btn-outline";
        delBtn.addEventListener("click", () => {
          if (
            confirm(
              `Delete order from "${
                order.customer_name || "this customer"
              }"?`
            )
          ) {
            deleteOrder(order.id);
          }
        });
        tdActions.appendChild(delBtn);

        tr.appendChild(tdTime);
        tr.appendChild(tdName);
        tr.appendChild(tdPhone);
        tr.appendChild(tdArea);
        tr.appendChild(tdTotal);
        tr.appendChild(tdProof);
        tr.appendChild(tdActions);

        adminOrdersTableBody.appendChild(tr);
      });
    }

    async function deleteOrder(orderId) {
      if (!orderId) {
        alert("Missing order id, cannot delete.");
        return;
      }

      try {
        const { error } = await supabase
          .from("orders")
          .delete()
          .eq("id", orderId);

        if (error) {
          console.error("Delete order error:", error);
          alert("Error deleting order: " + error.message);
          return;
        }

        await loadAdminOrders();
      } catch (err) {
        console.error("Unexpected delete order error:", err);
        alert("Unexpected error deleting order.");
      }
    }

    function addToCart(productId) {
      const product = products.find((p) => p.id === productId);
      if (!product) return;

      if (typeof product.stock === "number" && product.stock > 0) {
        const currentQty = cart[productId]?.qty || 0;
        if (currentQty >= product.stock) {
          alert("You have added maximum quantity available in stock.");
          return;
        }
      }

      if (!cart[productId]) {
        cart[productId] = { product, qty: 1 };
      } else {
        cart[productId].qty += 1;
      }
      renderCart();
      cartEl.classList.add("cart-open");
    }

    function changeQty(productId, delta) {
      if (!cart[productId]) return;
      cart[productId].qty += delta;
      if (cart[productId].qty <= 0) {
        delete cart[productId];
      }
      renderCart();
    }

    function clearCart() {
      for (const id in cart) {
        delete cart[id];
      }
      renderCart();
    }

    function calculateDeliveryCharge(subtotal) {
      if (subtotal === 0) return 0;
      if (subtotal >= 500) return 0;
      return 40;
    }

    function renderCart() {
      const items = Object.values(cart);
      cartListEl.innerHTML = "";

      if (!items.length) {
        cartListEl.innerHTML =
          '<div class="cart-empty">Add some masalas to see them here.</div>';
      } else {
        items.forEach(({ product, qty }) => {
          const row = document.createElement("div");
          row.className = "cart-item";

          const left = document.createElement("div");
          const name = document.createElement("div");
          name.className = "cart-item-name";
          name.textContent = product.name;

          const meta = document.createElement("div");
          meta.className = "cart-item-meta";
          meta.textContent = product.unit;

          const qtyBox = document.createElement("div");
          qtyBox.className = "cart-item-qty";
          const minusBtn = document.createElement("button");
          minusBtn.textContent = "-";
          minusBtn.addEventListener("click", () =>
            changeQty(product.id, -1)
          );
          const qtySpan = document.createElement("span");
          qtySpan.textContent = qty;
          const plusBtn = document.createElement("button");
          plusBtn.textContent = "+";
          plusBtn.addEventListener("click", () =>
            changeQty(product.id, 1)
          );

          qtyBox.appendChild(minusBtn);
          qtyBox.appendChild(qtySpan);
          qtyBox.appendChild(plusBtn);

          left.appendChild(name);
          left.appendChild(meta);
          left.appendChild(qtyBox);

          const right = document.createElement("div");
          right.className = "cart-item-price";
          right.textContent =
            "‚Çπ " + formatCurrency(product.price * qty);

          row.appendChild(left);
          row.appendChild(right);
          cartListEl.appendChild(row);
        });
      }

      let subtotal = 0;
      items.forEach(({ product, qty }) => {
        subtotal += Number(product.price || 0) * qty;
      });

      const delivery = calculateDeliveryCharge(subtotal);
      const total = subtotal + delivery;

      cartSubtotalEl.textContent = formatCurrency(subtotal);
      deliveryChargeEl.textContent = formatCurrency(delivery);
      cartTotalEl.textContent = formatCurrency(total);

      const totalItems = items.reduce((sum, item) => sum + item.qty, 0);
      cartCountEl.textContent = totalItems;
      if (cartFabCountEl) {
        cartFabCountEl.textContent = totalItems;
      }
    }

    function buildWhatsAppMessage() {
      const items = Object.values(cart);
      if (!items.length) {
        return "Hi MCP Masalas, I want to know more about your products.";
      }

      let message =
        "Hi MCP Masalas,%0A%0AI want to place the following order:%0A";
      items.forEach(({ product, qty }) => {
        message += `%0A‚Ä¢ ${product.name} (${product.unit}) x ${qty} = ‚Çπ${
          Number(product.price || 0) * qty
        }`;
      });

      const subtotal = parseInt(cartSubtotalEl.textContent || "0", 10);
      const delivery = parseInt(
        deliveryChargeEl.textContent || "0",
        10
      );
      const total = parseInt(cartTotalEl.textContent || "0", 10);

      message += `%0A%0ASubtotal: ‚Çπ${subtotal}`;
      message += `%0ADelivery: ‚Çπ${delivery}`;
      message += `%0ATotal: ‚Çπ${total}`;
      message += `%0A%0AName:`;
      message += `%0AAddress:`;
      message += `%0APayment mode (UPI/Cash):`;

      return message;
    }

    function openWhatsAppWithCart() {
      const msg = buildWhatsAppMessage();
      const url = `https://wa.me/${MCP_WHATSAPP_NUMBER}?text=${msg}`;
      window.open(url, "_blank");
    }

    function showAdminLoggedOut() {
      if (!adminLoggedOutEl || !adminLoggedInEl) return;
      adminLoggedOutEl.style.display = "block";
      adminLoggedInEl.style.display = "none";
      if (adminUserEmailEl) adminUserEmailEl.textContent = "";
    }

    function showAdminLoggedIn(user) {
      if (!adminLoggedOutEl || !adminLoggedInEl) return;
      adminLoggedOutEl.style.display = "none";
      adminLoggedInEl.style.display = "block";
      if (adminUserEmailEl) adminUserEmailEl.textContent = user.email || "";
      loadAdminProducts();
      loadAdminOrders();
    }

    async function checkAdminSessionOnLoad() {
      try {
        const { data, error } = await supabase.auth.getUser();
        console.log("checkAdminSessionOnLoad", { data, error });
        if (error || !data?.user) {
          showAdminLoggedOut();
        } else {
          showAdminLoggedIn(data.user);
        }
      } catch (err) {
        console.error("Error checking session:", err);
        showAdminLoggedOut();
      }
    }

    if (adminLoginForm) {
      adminLoginForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        showAdminMessage(adminAuthMsgEl, "Logging in...", "");
        console.log("Login form submitted");

        try {
          const email = adminEmailInput.value.trim();
          const password = adminPasswordInput.value;

          const { data, error } =
            await supabase.auth.signInWithPassword({
              email,
              password,
            });

          console.log("signInWithPassword result:", { data, error });

          if (error) {
            showAdminMessage(adminAuthMsgEl, error.message, "error");
            return;
          }

          showAdminMessage(
            adminAuthMsgEl,
            "Login successful.",
            "success"
          );
          showAdminLoggedIn(data.user);
        } catch (err) {
          console.error("Unexpected error during login:", err);
          showAdminMessage(
            adminAuthMsgEl,
            "Unexpected error during login (see console).",
            "error"
          );
        }
      });
    }

    if (adminLogoutBtn) {
      adminLogoutBtn.addEventListener("click", async () => {
        try {
          await supabase.auth.signOut();
          showAdminLoggedOut();
          showAdminMessage(adminAuthMsgEl, "Logged out.", "success");
        } catch (err) {
          console.error("Logout error:", err);
          showAdminMessage(
            adminAuthMsgEl,
            "Error logging out.",
            "error"
          );
        }
      });
    }

    async function loadAdminProducts() {
      try {
        const { data, error } = await supabase
          .from("products")
          .select("*")
          .order("sort_order", { ascending: true })
          .order("name", { ascending: true });

        if (error) {
          console.error("Admin load products error:", error);
          showAdminMessage(
            productFormMsgEl,
            "Error loading products.",
            "error"
          );
          return;
        }

        renderAdminProductsTable(data || []);
      } catch (err) {
        console.error("Admin load products unexpected error:", err);
        showAdminMessage(
          productFormMsgEl,
          "Unexpected error loading products.",
          "error"
        );
      }
    }

    function renderAdminProductsTable(list) {
      adminProductsTableBody.innerHTML = "";
      list.forEach((prod) => {
        const tr = document.createElement("tr");

        const tdName = document.createElement("td");
        tdName.textContent = prod.name;

        const tdType = document.createElement("td");
        tdType.textContent = prod.type;

        const tdPrice = document.createElement("td");
        tdPrice.textContent = `‚Çπ ${formatCurrency(prod.price)}`;

        const tdUnit = document.createElement("td");
        tdUnit.textContent = prod.unit;

        const tdStock = document.createElement("td");
        tdStock.textContent = prod.stock ?? "-";

        const tdStatus = document.createElement("td");
        const badge = document.createElement("span");
        badge.classList.add("admin-badge");
        if (prod.is_active) {
          badge.classList.add("admin-badge-active");
          badge.textContent = "Active";
        } else {
          badge.classList.add("admin-badge-inactive");
          badge.textContent = "Inactive";
        }
        tdStatus.appendChild(badge);

        const tdActions = document.createElement("td");
        const editBtn = document.createElement("button");
        editBtn.textContent = "Edit";
        editBtn.className = "btn-small btn-outline";
        editBtn.style.marginRight = "0.25rem";
        editBtn.addEventListener("click", () =>
          fillProductFormForEdit(prod)
        );

        const delBtn = document.createElement("button");
        delBtn.textContent = "Delete";
        delBtn.className = "btn-small btn-outline";
        delBtn.addEventListener("click", () => {
          if (confirm(`Delete "${prod.name}"?`)) {
            deleteProduct(prod.id);
          }
        });

        tdActions.appendChild(editBtn);
        tdActions.appendChild(delBtn);

        tr.appendChild(tdName);
        tr.appendChild(tdType);
        tr.appendChild(tdPrice);
        tr.appendChild(tdUnit);
        tr.appendChild(tdStock);
        tr.appendChild(tdStatus);
        tr.appendChild(tdActions);

        adminProductsTableBody.appendChild(tr);
      });
    }

    function fillProductFormForEdit(prod) {
      productIdInput.value = prod.id;
      productNameInput.value = prod.name;
      productTypeInput.value = prod.type;
      productPriceInput.value = prod.price;
      productUnitInput.value = prod.unit;
      productTagInput.value = prod.tag || "";
      productImgUrlInput.value = prod.img_url || "";
      productStockInput.value = prod.stock ?? 0;
      productSortOrderInput.value = prod.sort_order ?? 0;
      productIsActiveInput.value = prod.is_active ? "true" : "false";
      productNameInput.focus();
      showAdminMessage(
        productFormMsgEl,
        "Editing existing product.",
        ""
      );
    }

    function resetProductForm() {
      productIdInput.value = "";
      productNameInput.value = "";
      productTypeInput.value = "blend";
      productPriceInput.value = "";
      productUnitInput.value = "100 g";
      productTagInput.value = "";
      productImgUrlInput.value = "";
      productStockInput.value = "";
      productSortOrderInput.value = "";
      productIsActiveInput.value = "true";
      showAdminMessage(productFormMsgEl, "", "");
    }

    productResetBtn.addEventListener("click", (e) => {
      e.preventDefault();
      resetProductForm();
    });

    productForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      showAdminMessage(productFormMsgEl, "Saving...", "");

      const payload = {
        name: productNameInput.value.trim(),
        type: productTypeInput.value,
        price: Number(productPriceInput.value || 0),
        unit: productUnitInput.value.trim(),
        tag: productTagInput.value.trim() || null,
        img_url: productImgUrlInput.value.trim() || null,
        stock:
          productStockInput.value === ""
            ? null
            : Number(productStockInput.value),
        sort_order:
          productSortOrderInput.value === ""
            ? 0
            : Number(productSortOrderInput.value),
        is_active: productIsActiveInput.value === "true",
      };

      const id = productIdInput.value;

      try {
        if (id) {
          const { error } = await supabase
            .from("products")
            .update(payload)
            .eq("id", id);
          if (error) {
            showAdminMessage(productFormMsgEl, error.message, "error");
            return;
          }
          showAdminMessage(
            productFormMsgEl,
            "Product updated.",
            "success"
          );
        } else {
          const { error } = await supabase
            .from("products")
            .insert([payload]);
          if (error) {
            showAdminMessage(productFormMsgEl, error.message, "error");
            return;
          }
          showAdminMessage(
            productFormMsgEl,
            "Product added.",
            "success"
          );
        }

        resetProductForm();
        await loadProductsFromSupabase();
        await loadAdminProducts();
      } catch (err) {
        showAdminMessage(
          productFormMsgEl,
          "Unexpected error saving product.",
          "error"
        );
      }
    });

    async function deleteProduct(id) {
      showAdminMessage(productFormMsgEl, "Deleting...", "");
      try {
        const { error } = await supabase
          .from("products")
          .delete()
          .eq("id", id);
        if (error) {
          showAdminMessage(productFormMsgEl, error.message, "error");
          return;
        }
        showAdminMessage(
          productFormMsgEl,
          "Product deleted.",
          "success"
        );
        await loadProductsFromSupabase();
        await loadAdminProducts();
      } catch (err) {
        showAdminMessage(
          productFormMsgEl,
          "Unexpected error deleting product.",
          "error"
        );
      }
    }

    document.querySelectorAll(".chip").forEach((chip) => {
      chip.addEventListener("click", () => {
        document
          .querySelectorAll(".chip")
          .forEach((c) => c.classList.remove("active"));
        chip.classList.add("active");
        currentFilter = chip.dataset.filter || "all";
        renderProducts();
      });
    });

    document
      .getElementById("scrollToProducts")
      .addEventListener("click", () => {
        document
          .getElementById("products")
          .scrollIntoView({ behavior: "smooth" });
      });

    document
      .getElementById("checkoutWhatsApp")
      .addEventListener("click", () => {
        localStorage.setItem("mcpCartData", JSON.stringify(cart));
        localStorage.setItem(
          "mcpCartTotals",
          JSON.stringify({
            subtotal: cartSubtotalEl.textContent,
            delivery: deliveryChargeEl.textContent,
            total: cartTotalEl.textContent,
          })
        );
        window.location.href = "order.html";
      });

    document
      .getElementById("navWhatsAppBtn")
      .addEventListener("click", () => {
        window.open(`https://wa.me/${MCP_WHATSAPP_NUMBER}`, "_blank");
      });
    document
      .getElementById("heroWhatsAppBtn")
      .addEventListener("click", () => {
        window.open(`https://wa.me/${MCP_WHATSAPP_NUMBER}`, "_blank");
      });

    document
      .getElementById("clearCart")
      .addEventListener("click", clearCart);

    cartFab.addEventListener("click", () => {
      cartEl.classList.toggle("cart-open");
    });

    (async function init() {
      await loadProductsFromSupabase();
      renderCart();
      await checkAdminSessionOnLoad();
    })();
  </script>
</body>
</html>

